{"ast":null,"code":"import GOOGLE_SCRIPT from 'authConstants.js';\nexport function* authorizeWithGoogle() {\n  const provider = PROVIDER.GOOGLE;\n\n  try {\n    if (!googleAuthAvailable()) {\n      yield call(() => new Promise(resolve => loadScript(GOOGLE_SCRIPT, () => {\n        const g = window.gapi;\n        g.load('auth2', () => {\n          g.auth2.init({\n            client_id: GOOGLE_CLIENT_ID,\n            scope: GOOGLE_SCOPE\n          });\n          resolve();\n        });\n      })));\n    }\n\n    const ga = window.gapi.auth2.getAuthInstance();\n    const googleUser = yield call(() => new Promise((resolve, reject) => ga.signIn().then(resolve, reject)));\n    const {\n      id_token\n    } = googleUser.getAuthResponse();\n    yield* authorize(provider, id_token);\n  } catch (err) {\n    reportError(provider, err);\n  }\n}\nexport function* authorizeWithFacebook() {\n  const provider = PROVIDER.FACEBOOK;\n\n  try {\n    if (!window.FB) {\n      yield call(() => new Promise(resolve => loadScript(FACEBOOK_SCRIPT, resolve)));\n      yield call(() => new Promise(resolve => {\n        window.fbAsyncInit = () => {\n          window.FB.init({\n            appId: FACEBOOK_APP_ID,\n            version: FACEBOOK_VERSION\n          });\n          resolve();\n        };\n      }));\n    }\n\n    const fb = window.FB;\n    const response = yield call(() => new Promise(resolve => fb.login(resolve, {\n      scope: FACEBOOK_SCOPE\n    })));\n\n    if (response && response.authResponse) {\n      const {\n        accessToken\n      } = response.authResponse;\n      if (!accessToken) return;\n      yield* authorize(provider, accessToken);\n    }\n  } catch (err) {\n    reportError(provider, err);\n  }\n}\nexport const loadScript = (src, onLoad) => {\n  const script = document.createElement('script');\n  script.src = src;\n  script.async = true;\n  document.body.appendChild(script);\n  script.onload = onLoad;\n};","map":{"version":3,"sources":["/Users/AtokAdos/Desktop/CS_Projects/U4Ea/u4ea/client/src/js/auth.js"],"names":["GOOGLE_SCRIPT","authorizeWithGoogle","provider","PROVIDER","GOOGLE","googleAuthAvailable","call","Promise","resolve","loadScript","g","window","gapi","load","auth2","init","client_id","GOOGLE_CLIENT_ID","scope","GOOGLE_SCOPE","ga","getAuthInstance","googleUser","reject","signIn","then","id_token","getAuthResponse","authorize","err","reportError","authorizeWithFacebook","FACEBOOK","FB","FACEBOOK_SCRIPT","fbAsyncInit","appId","FACEBOOK_APP_ID","version","FACEBOOK_VERSION","fb","response","login","FACEBOOK_SCOPE","authResponse","accessToken","src","onLoad","script","document","createElement","async","body","appendChild","onload"],"mappings":"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","sourcesContent":["import GOOGLE_SCRIPT from 'authConstants.js'\n\nexport function* authorizeWithGoogle() {\n    const provider = PROVIDER.GOOGLE\n    try {\n      if (!googleAuthAvailable()) {\n        yield call(() => new Promise(resolve => loadScript(\n          GOOGLE_SCRIPT,\n          () => {\n            const g = window.gapi\n            g.load('auth2', () => {\n              g.auth2.init({\n                client_id: GOOGLE_CLIENT_ID,\n                scope: GOOGLE_SCOPE\n              })\n              resolve()\n            })\n          }\n        )))\n      }\n      const ga = window.gapi.auth2.getAuthInstance()\n      const googleUser = yield call(() => new Promise((resolve, reject) => ga.signIn().then(resolve, reject)))\n      const { id_token } = googleUser.getAuthResponse()\n  \n      yield * authorize(provider, id_token)\n    } catch(err) {\n      reportError(provider, err)\n    }\n  }\n  \n  export function* authorizeWithFacebook() {\n    const provider = PROVIDER.FACEBOOK\n    try {\n      if (!window.FB) {\n        yield call(() => new Promise(resolve => loadScript(FACEBOOK_SCRIPT, resolve)))\n        yield call(() => new Promise(resolve => {\n          window.fbAsyncInit = () => {\n            window.FB.init({\n              appId: FACEBOOK_APP_ID,\n              version : FACEBOOK_VERSION\n            })\n            resolve()\n          }\n        }))\n      }\n  \n      const fb = window.FB\n      const response = yield call(() => new Promise(resolve => fb.login(resolve, { scope: FACEBOOK_SCOPE })))\n      if (response && response.authResponse) {\n        const { accessToken } = response.authResponse\n        if (!accessToken) return\n    \n        yield * authorize(provider, accessToken)\n      }\n    } catch(err) {\n      reportError(provider, err)\n    }\n  }\n\n\n  export const loadScript = (src, onLoad) => {\n    const script = document.createElement('script')\n    script.src = src\n    script.async = true\n    document.body.appendChild(script)\n    script.onload = onLoad\n  }"]},"metadata":{},"sourceType":"module"}